<?php
// function __autoload($classname){
//   include "$classname.php";
// }

class student extends dbConnection {
  protected $conn;

  public function __construct(){

    $dbConnection = new dbConnection();
    $this->conn = $dbConnection->connect();
  }
  /*
  ********************************************************************************************
  ADD STUDENT TO TO STUDENT TABLE AND RETURNS STUD_ID GENERATED BY THE THAT PARTICULAR STUDENT
  ********************************************************************************************
  */
  public function addStudent(string $name, string $year){
    $stud_id = " ";
    $query = "INSERT INTO students(name, year) values(?, ?)";
    $stmt = $this->conn->prepare($query);
    $stmt->execute([$name, $year]);
    if($stmt){
      $sql = "SELECT max(stud_id) from students";
      $stmt1 = $this->conn->query($sql);
      $row = $stmt1->fetch();
      $stud_id = $row['max(stud_id)'];
    }
    return $stud_id;
  }

  /*
  ********************************************************************************************
          WILL RETURN ALL THE STUDENT DATA WHICH BELONGS TO THAT PARTICULAR YEAR
  ********************************************************************************************
  */
  public function getAllByYear(string $year){
    $rows = array();
    $query = "SELECT stud_id, name from students where year = ?";
    $stmt = $this->conn->prepare($query);
    $stmt->execute([$year]);
    $rows = $stmt->fetchAll();
    return $rows;
  }

}//end of class student

?>
